name: "Terraform Format Check"
description: "Run Terratest tests."

runs:
  using: "composite"

  steps:
    - name: Check for Terraform files
      id: find_files
      shell: bash
      run: |
        terraform_files=$(find . -type f -name "*.tf")
        if [ -z "$terraform_files" ]; then
          echo "No Terraform files found."
          exit 0
        fi
        echo "terraform_files=$terraform_files" >> "$GITHUB_ENV"

    - name: Terraform Format Check
      id: format_check
      shell: bash
      run: |
        for file in ${{env.terraform_files}}; do
          echo "Formatting $file"
          terraform fmt -check "$file"
        done
